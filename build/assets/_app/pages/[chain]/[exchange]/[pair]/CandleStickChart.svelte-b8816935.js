var de=Object.defineProperty,fe=Object.defineProperties;var he=Object.getOwnPropertyDescriptors;var X=Object.getOwnPropertySymbols;var me=Object.prototype.hasOwnProperty,_e=Object.prototype.propertyIsEnumerable;var O=(a,e,t)=>e in a?de(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,Y=(a,e)=>{for(var t in e||(e={}))me.call(e,t)&&O(a,t,e[t]);if(X)for(var t of X(e))_e.call(e,t)&&O(a,t,e[t]);return a},Q=(a,e)=>fe(a,he(e));import{_ as pe}from"../../../../chunks/preload-helper-ec9aa979.js";import{S as J,i as K,s as Z,M as ve,a7 as k,a8 as x,a as g,d as v,b as s,f as P,Q as M,F as ye,G as ge,H as be,x as D,u as L,e as q,c as F,w as we,A as Ce,r as ke,j as xe,m as Me,o as Ee,Y as S,v as Pe,l as $,t as Se,g as Ae}from"../../../../chunks/vendor-475ceb10.js";import{d as Te,a as ee}from"../../../../chunks/formatters-70d542d8.js";function ze(a){let e;return{c(){e=k("rect"),this.h()},l(t){e=x(t,"rect",{width:!0,height:!0,x:!0,y:!0,rx:!0,ry:!0}),g(e).forEach(v),this.h()},h(){s(e,"width","100%"),s(e,"height","100%"),s(e,"x","0"),s(e,"y","0"),s(e,"rx","1"),s(e,"ry","1")},m(t,n){P(t,e,n)},d(t){t&&v(e)}}}function te(a){let e,t,n,l,i,h;return{c(){e=k("animate"),l=k("animate"),this.h()},l(c){e=x(c,"animate",{attributeName:!0,from:!0,to:!0,dur:!0,repeatCount:!0}),g(e).forEach(v),l=x(c,"animate",{attributeName:!0,from:!0,to:!0,dur:!0,repeatCount:!0}),g(l).forEach(v),this.h()},h(){s(e,"attributeName","x1"),s(e,"from",t="-"+a[6]+"%"),s(e,"to","100%"),s(e,"dur",n=""+(a[4]+"s")),s(e,"repeatCount","indefinite"),s(l,"attributeName","x2"),s(l,"from","0%"),s(l,"to",i=""+(100+a[6]+"%")),s(l,"dur",h=""+(a[4]+"s")),s(l,"repeatCount","indefinite")},m(c,r){P(c,e,r),P(c,l,r)},p(c,r){r&64&&t!==(t="-"+c[6]+"%")&&s(e,"from",t),r&16&&n!==(n=""+(c[4]+"s"))&&s(e,"dur",n),r&64&&i!==(i=""+(100+c[6]+"%"))&&s(l,"to",i),r&16&&h!==(h=""+(c[4]+"s"))&&s(l,"dur",h)},d(c){c&&v(e),c&&v(l)}}}function Ye(a){let e,t,n,l,i,h,c,r,d,o;const _=a[10].default,p=ve(_,a,a[9],null),f=p||ze();let u=a[5]&&te(a);return{c(){e=k("svg"),t=k("rect"),n=k("defs"),l=k("clipPath"),f&&f.c(),i=k("linearGradient"),u&&u.c(),h=k("stop"),c=k("stop"),r=k("stop"),this.h()},l(m){e=x(m,"svg",{viewBox:!0,class:!0,"aria-labelledby":!0,preserveAspectRatio:!0});var y=g(e);t=x(y,"rect",{fill:!0,"clip-path":!0,width:!0,height:!0,x:!0,y:!0}),g(t).forEach(v),n=x(y,"defs",{});var w=g(n);l=x(w,"clipPath",{id:!0});var b=g(l);f&&f.l(b),b.forEach(v),i=x(w,"linearGradient",{id:!0,x1:!0,y1:!0,x2:!0,y2:!0});var C=g(i);u&&u.l(C),h=x(C,"stop",{"stop-color":!0,offset:!0}),g(h).forEach(v),c=x(C,"stop",{"stop-color":!0,offset:!0}),g(c).forEach(v),r=x(C,"stop",{"stop-color":!0,offset:!0}),g(r).forEach(v),C.forEach(v),w.forEach(v),y.forEach(v),this.h()},h(){s(t,"fill","url(#"+a[8]+")"),s(t,"clip-path","url(#"+a[7]+")"),s(t,"width",a[3]),s(t,"height",a[2]),s(t,"x","0"),s(t,"y","0"),s(l,"id",a[7]),s(h,"stop-color",a[1]),s(h,"offset","0%"),s(c,"stop-color",a[0]),s(c,"offset","50%"),s(r,"stop-color",a[1]),s(r,"offset","100%"),s(i,"id",a[8]),s(i,"x1",d="-"+a[6]+"%"),s(i,"y1","50%"),s(i,"x2","0%"),s(i,"y2","50%"),s(e,"viewBox","0 0 100 100"),s(e,"class","skeleton svelte-1ftty70"),s(e,"aria-labelledby","loading-aria"),s(e,"preserveAspectRatio","none")},m(m,y){P(m,e,y),M(e,t),M(e,n),M(n,l),f&&f.m(l,null),M(n,i),u&&u.m(i,null),M(i,h),M(i,c),M(i,r),o=!0},p(m,[y]){(!o||y&8)&&s(t,"width",m[3]),(!o||y&4)&&s(t,"height",m[2]),p&&p.p&&(!o||y&512)&&ye(p,_,m,m[9],o?be(_,m[9],y,null):ge(m[9]),null),m[5]?u?u.p(m,y):(u=te(m),u.c(),u.m(i,h)):u&&(u.d(1),u=null),(!o||y&2)&&s(h,"stop-color",m[1]),(!o||y&1)&&s(c,"stop-color",m[0]),(!o||y&2)&&s(r,"stop-color",m[1]),(!o||y&64&&d!==(d="-"+m[6]+"%"))&&s(i,"x1",d)},i(m){o||(D(f,m),o=!0)},o(m){L(f,m),o=!1},d(m){m&&v(e),f&&f.d(m),u&&u.d()}}}function le(){return Math.random().toString(36).substring(2)}function De(a,e,t){let{$$slots:n={},$$scope:l}=e,{secondaryColor:i="#FFF1E5"}=e,{primaryColor:h="#CCBEB3"}=e,{height:c=200}=e,{width:r=400}=e,{speed:d=2}=e,{animate:o=!0}=e,{secondaryColorPercentWidth:_=100}=e,p=le(),f=le();return a.$$set=u=>{"secondaryColor"in u&&t(0,i=u.secondaryColor),"primaryColor"in u&&t(1,h=u.primaryColor),"height"in u&&t(2,c=u.height),"width"in u&&t(3,r=u.width),"speed"in u&&t(4,d=u.speed),"animate"in u&&t(5,o=u.animate),"secondaryColorPercentWidth"in u&&t(6,_=u.secondaryColorPercentWidth),"$$scope"in u&&t(9,l=u.$$scope)},[i,h,c,r,d,o,_,p,f,l,n]}class Le extends J{constructor(e){super();K(this,e,De,Ye,Z,{secondaryColor:0,primaryColor:1,height:2,width:3,speed:4,animate:5,secondaryColorPercentWidth:6})}}let E=null,T=null;function Re(a,e){var t=!1;return()=>{t||(requestAnimationFrame(a),t=!0,setTimeout(()=>{t=!1},e))}}function A(a,e){return"$"+a.toFixed(e).replace(/\d(?=(\d{3})+(?:\.|$))/g,"$&,")}function We({className:a,style:e={backgroundColor:"rgba(51,204,255,0.3)"}}={}){let t,n,l,i;function h(r){t=r.under,n=r.over,l=document.createElement("div"),a&&l.classList.add(a),E.assign(l.style,Y({pointerEvents:"none",display:"none",position:"absolute",left:0,top:0,height:"100%"},e)),t.appendChild(l),n.addEventListener("mouseenter",()=>{l.style.display=null}),n.addEventListener("mouseleave",()=>{l.style.display="none"})}function c(r){if(i!==r.cursor.idx){i=r.cursor.idx;let[d,o]=r.series[0].idxs;const _=o-d,p=r.bbox.width/_/devicePixelRatio,f=r.scales.x.distr==2?i:r.data[0][i],u=r.valToPos(f,"x")-p/2;l.style.transform="translateX("+Math.round(u)+"px)",l.style.width=Math.round(p)+"px"}}return{opts:(r,d)=>{E.assign(d,{cursor:{x:!1,y:!1}})},hooks:{init:h,setCursor:c}}}function Ve({className:a,style:e={backgroundColor:"rgba(255, 249, 196, 0.92)",color:"black"}}={}){let t;function n(i,h){t=i.root.querySelector(".u-legend"),t.classList.remove("u-inline"),a&&t.classList.add(a),E.assign(t.style,Y({textAlign:"left",pointerEvents:"none",display:"none",position:"absolute",left:0,top:0,zIndex:100,boxShadow:"2px 2px 10px rgba(0,0,0,0.5)"},e));const c=t.querySelectorAll(".u-marker");for(let d=0;d<c.length;d++)c[d].style.display="none";const r=i.over;r.style.overflow="visible",r.appendChild(t),r.addEventListener("mouseenter",()=>{t.style.display=null}),r.addEventListener("mouseleave",()=>{t.style.display="none"})}function l(i){const{left:h,top:c}=i.cursor;t.style.transform="translate("+h+"px, "+c+"px)"}return{hooks:{init:n,setCursor:l}}}function Be(){const a=2,e="#000000",t="#cc0000",n="#458b00",l="#bea6a0",i="#a6ae9d",h=20,c=2,r=1;function d(o){o.ctx.save();const _=c%2/2;o.ctx.translate(_,_);let[p,f]=o.series[0].idxs,u=o.valToPos(0,"vol",!0);for(let m=p;m<=f;m++){let y=o.scales.x.distr==2?m:o.data[0][m],w=o.data[1][m],b=o.data[2][m],C=o.data[3][m],R=o.data[4][m],ae=o.data[5][m],H=o.valToPos(y,"x",!0),W=o.valToPos(C,"y",!0),V=o.valToPos(b,"y",!0),B=o.valToPos(w,"y",!0),G=o.valToPos(R,"y",!0),j=o.valToPos(ae,"vol",!0),ne=Math.max(V,W)-Math.min(V,W),re=H-c/2,ie=Math.min(V,W);o.ctx.fillStyle=e,o.ctx.fillRect(Math.round(re),Math.round(ie),Math.round(c),Math.round(ne));let se=o.bbox.width/(f-p),z=Math.min(h,se-a),N=Math.max(G,B)-Math.min(G,B),I=H-z/2,U=Math.min(G,B),ce=w>R?t:n;o.ctx.fillStyle=e,o.ctx.fillRect(Math.round(I),Math.round(U),Math.round(z),Math.round(N)),o.ctx.fillStyle=ce,o.ctx.fillRect(Math.round(I+r),Math.round(U+r),Math.round(z-r*2),Math.round(N-r*2));const ue=w>R?l:i;o.ctx.fillStyle=ue,o.ctx.fillRect(Math.round(I),Math.round(j),Math.round(z),Math.round(u-j))}o.ctx.translate(-_,-_),o.ctx.restore()}return{opts:(o,_)=>{E.assign(_,{cursor:{points:{show:!1}}}),_.series.forEach(p=>{p.paths=()=>null,p.points={show:!1}})},hooks:{draw:d}}}function oe(a){a.querySelectorAll(".uplot").forEach(function(t){a.removeChild(t)}),T&&(window.removeEventListener("resize",T),T=null)}function Ge(a,e,t,n){console.log("Starting drawCandleStickChart",e),E=a,oe(t);let l=Math.max.apply(null,n[5]);E.fmtDate("{YYYY}-{MM}-{DD}");const i=p=>E.tzDate(new Date(p*1e3),"Etc/UTC");function h(){return{width:t.offsetWidth,height:t.offsetHeight}}const c=h(),r=c.width>900;let d;r?d=[{},{label:"Price",space:40,size:60,gap:0,values:(p,f)=>f.map(u=>A(u,0))},{label:"Volume",side:1,space:40,size:80,scale:"vol",grid:{show:!1},values:(p,f)=>f.map(u=>ee(u,1,1))}]:d=[{},{space:40,size:40,gap:0,values:(p,f)=>f.map(u=>A(u,0))},{side:1,space:40,size:40,scale:"vol",grid:{show:!1}}];const o=Q(Y({},c),{title:e,tzDate:i,plugins:[We(),Ve(),Be()],scales:{x:{distr:2},vol:{range:[0,l*3]}},series:[{label:"Time",value:(p,f)=>Te(f)},{label:"Open",value:(p,f)=>A(f,2)},{label:"High",value:(p,f)=>A(f,2)},{label:"Low",value:(p,f)=>A(f,2)},{label:"Close",value:(p,f)=>A(f,2)},{label:"Volume",scale:"vol",value:(p,f)=>ee(f)}],axes:d});let _=new E(o,n,t);T=Re(()=>_.setSize(h()),100),window.addEventListener("resize",T)}function Ie(a){let e,t;return e=new Le({}),{c(){xe(e.$$.fragment)},l(n){Me(e.$$.fragment,n)},m(n,l){Ee(e,n,l),t=!0},p:S,i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){Pe(e,n)}}}function qe(a){let e;function t(i,h){return i[0].length===0?He:Fe}let n=t(a),l=n(a);return{c(){l.c(),e=$()},l(i){l.l(i),e=$()},m(i,h){l.m(i,h),P(i,e,h)},p(i,h){n!==(n=t(i))&&(l.d(1),l=n(i),l&&(l.c(),l.m(e.parentNode,e)))},i:S,o:S,d(i){l.d(i),i&&v(e)}}}function Fe(a){return{c:S,l:S,m:S,d:S}}function He(a){let e,t;return{c(){e=q("p"),t=Se("No data available for the selected period")},l(n){e=F(n,"P",{});var l=g(e);t=Ae(l,"No data available for the selected period"),l.forEach(v)},m(n,l){P(n,e,l),M(e,t)},d(n){n&&v(e)}}}function je(a){let e,t,n,l,i;const h=[qe,Ie],c=[];function r(d,o){return d[0]?0:1}return n=r(a),l=c[n]=h[n](a),{c(){e=q("div"),t=q("div"),l.c(),this.h()},l(d){e=F(d,"DIV",{class:!0});var o=g(e);t=F(o,"DIV",{id:!0,class:!0});var _=g(t);l.l(_),_.forEach(v),o.forEach(v),this.h()},h(){s(t,"id","uplot-wrapper"),s(t,"class","svelte-18dce2g"),s(e,"class","candle-stick-chart")},m(d,o){P(d,e,o),M(e,t),c[n].m(t,null),i=!0},p(d,[o]){let _=n;n=r(d),n===_?c[n].p(d,o):(ke(),L(c[_],1,1,()=>{c[_]=null}),we(),l=c[n],l?l.p(d,o):(l=c[n]=h[n](d),l.c()),D(l,1),l.m(t,null))},i(d){i||(D(l),i=!0)},o(d){L(l),i=!1},d(d){d&&v(e),c[n].d()}}}function Ne(a,e,t){var n=this&&this.__awaiter||function(r,d,o,_){function p(f){return f instanceof o?f:new o(function(u){u(f)})}return new(o||(o=Promise))(function(f,u){function m(b){try{w(_.next(b))}catch(C){u(C)}}function y(b){try{w(_.throw(b))}catch(C){u(C)}}function w(b){b.done?f(b.value):p(b.value).then(m,y)}w((_=_.apply(r,d||[])).next())})};let{candles:l=null}=e,{title:i=""}=e,h;function c(r,d){if(!d)return;const o=document.getElementById("uplot-wrapper");if(!r){oe(o);return}console.log("Redrawing candles",r),Ge(d,i,o,r)}return Ce(()=>n(void 0,void 0,void 0,function*(){{const r=yield pe(()=>import("../../../../chunks/uPlot.esm-25ea13de.js"),[]);console.log("uplot dynamically imported",r,r.default),t(2,h=r.default)}})),a.$$set=r=>{"candles"in r&&t(0,l=r.candles),"title"in r&&t(1,i=r.title)},a.$$.update=()=>{a.$$.dirty&5&&c(l,h)},[l,i,h]}class Je extends J{constructor(e){super();K(this,e,Ne,je,Z,{candles:0,title:1})}}export{Je as default};
